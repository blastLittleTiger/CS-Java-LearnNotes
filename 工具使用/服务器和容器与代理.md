### 服务器和容器与代理

#### 概述
常见的服务器为HTTP服务器, 有Apache, Nginx, 容器的话有Tomcat, Jetty, Jboss等

##### apache与nginx的区别：
1.**二者最核心的区别在于apache是同步多进程模型，一个连接对应一个进程；nginx是异步的，多个连接（万级别）可以对应一个进程** 。nginx处理静态文件好,耗费内存少，但无疑apache仍然是目前的主流，有很多丰富的特性。所以还需要搭配着来.当然如果能确定nginx就适合需求，那么使用nginx会是更经济的方式。
2.nginx的负载能力比apache高很多。最新的服务器也改用nginx了。而且nginx改完配置能-t测试一下配置有没有问题。
3.apache重启的时候发现配置出错了，会很崩溃，改的时候都会非常小心翼翼现在看有好多集群站，前端nginx抗并发，后端apache集群， 配合的也不错。
3.nginx处理动态请求是鸡肋，一般动态请求要apache去做，**nginx只适合静态和反向**。
5.从经验来看，**nginx是很不错的前端服务器，负载性能很好**，nginx，用webbench模拟10000个静态文件请求毫不吃力。 apache对php等语言的支持很好，此外apache有强大的支持网络，发展时间相对nginx更久，bug少但是apache有先天不支持多核心处理负载鸡肋的缺点，建议使用nginx做前端，后端用apache。大型网站建议用nginx自代的集群功能。
6.大部分情况下nginx都优于APACHE，比如说静态文件处理、PHP-CGI的支持、反向代理功能、前端 Cache、维持连接等等。在Apache+PHP（prefork）模式下，如果PHP处理慢或者前端压力很大的情况下，很容易出现Apache进程数飙升，从而拒绝服务的现象。
7.**Apache在处理动态有优势，Nginx并发性比较好，CPU内存占用低，如果rewrite频繁，那还是Apache吧**！
8.一般来说，需要性能的web 服务，用nginx 。如果不需要性能只求稳定，那就apache 吧。



##### HTTP服务器和应用服务器的差异
Apache/Nginx 应该叫做「HTTP Server」，**HTTP服务器**；而 Tomcat 则是一个「Application Server」，或者更准确的来说，是一个「Servlet/JSP」的**应用容器（服务器）**（Ruby/Python 等其他语言开发的应用也无法直接运行在 Tomcat 上）。
**一个 HTTP Server 关心的是 HTTP 协议层面的传输和访问控制，所以在 Apache/Nginx 上你可以看到代理、负载均衡等功能**。客户端通过 HTTP Server 访问服务器上存储的资源（HTML 文件、图片文件等等）。通过 CGI 技术，也可以将处理过的内容通过 HTTP Server 分发，**但是一个 HTTP Server 始终只是把服务器上的文件如实的通过 HTTP 协议传输给客户端**。
**而应用服务器，则是一个应用执行的容器**。它首先需要支持开发语言的 Runtime（对于 Tomcat 来说，就是 Java），保证应用能够在应用服务器上正常运行。其次，需要支持应用相关的规范，例如类库、安全方面的特性。对于 Tomcat 来说，就是需要提供 JSP/Sevlet 运行需要的标准类库、Interface 等。为了方便，应用服务器往往也会集成 HTTP Server 的功能，但是不如专业的 HTTP Server 那么强大，所以应用服务器往往是运行在 HTTP Server 的背后，执行应用，将动态的内容转化为静态的内容之后，通过 HTTP Server 分发到客户端。



#### 正向代理和反向代理
##### 代理服务器
Proxy Serve，提供代理服务的电脑系统或其它类型的网络终端，代替网络用户去取得网络信息。



##### 为什么使用代理服务器
1.**提高访问速度** :由于目标主机返回的数据会存放在代理服务器的硬盘中，因此下一次客户再访问相同的站点数据时，会直接从代理服务器的硬盘中读取，起到了缓存的作用，尤其对于热门网站能明显提高访问速度。
2.**防火墙作用** : 由于所有的客户机请求都必须通过代理服务器访问远程站点，因此可以在代理服务器上设限，过滤掉某些不安全信息。同时正向代理中上网者可以隐藏自己的IP,免受攻击。
3.**突破访问限制 **: 互联网上有许多开发的代理服务器，客户机在访问受限时，可通过不受限的代理服务器访问目标站点，通俗说，我们使用的翻墙浏览器就是利用了代理服务器，可以直接访问外网。



##### 正向代理
正向代理通过上面的图理解其实就是用户想从服务器拿资源数据，但是只能通过proxy服务器才能拿到，所以用户A只能去访问proxy服务器然后通过proxy服务器去服务器B拿数据，这种情况用户是明确知道你要访问的是谁，在我们生活中最典型的案例就是“翻墙“了，也是通过访问代理服务器最后访问外网的。
![zhengxiandaili](../images/zhengxiandaili.jpg)
##### 反向代理
反向代理其实就是客户端去访问服务器时，他并不知道会访问哪一台，感觉就是客户端访问了Proxy一样，而实则就是当proxy关口拿到用户请求的时候会转发到代理服务器中的随机（算法）某一台。而在用户看来，他只是访问了Proxy服务器而已，典型的例子就是负载均衡了。


![zhengxiandaili2](../images/zhengxiandaili2.png)

##### 正向代理和反向代理的区别
1.位置不同 
正向代理，架设在客户机和目标主机之间； 
反向代理，架设在服务器端；
2.代理对象不同 
正向代理，代理客户端，服务端不知道实际发起请求的客户端； 
反向代理，代理服务端，客户端不知道实际提供服务的服务端； 
例子：正向代理–HTTP代理为多个人提供翻墙服务；反向代理–百度外卖为多个商户提供平台给某个用户提供外卖服务。
3.用途不同 
正向代理，为在防火墙内的局域网客户端提供访问Internet的途径； 
反向代理，将防火墙后面的服务器提供给Internet访问；
4.安全性不同 
正向代理允许客户端通过它访问任意网站并且隐藏客户端自身，因此必须采取安全措施以确保仅为授权的客户端提供服务； 
反向代理都对外都是透明的，访问者并不知道自己访问的是哪一个代理。

##### 代理的应用
###### 正向代理的应用
1. 访问原来无法访问的资源 
2. 用作缓存，加速访问速度 
3. 对客户端访问授权，上网进行认证 
4. 代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息

###### 反向代理的应用
1. 保护内网安全 
2. 负载均衡 
3. 缓存，减少服务器的压力 
Nginx作为最近较火的反向代理服务器，安装在目的主机端，主要用于转发客户机请求，后台有多个http服务器提供服务，nginx的功能就是把请求转发给后台的服务器，决定哪台目标主机来处理当前请求。

##### 总结
正向代理是从客户端的角度出发，服务于特定用户（比如说一个局域网内的客户）以访问非特定的服务；反向代理正好与此相反，从服务端的角度出发，服务于非特定用户（通常是所有用户），已访问特定的服务。 

ref：
1.[nginx和tomcat的区别](http://www.cnblogs.com/flypie/p/5153702.html)   2.[web服务器该选择apache还是nginx](https://blog.csdn.net/sinat_34222970/article/details/54585684),   3.[nginx,tomcat,apache三者分别用来做什么，有何区别](https://www.cnblogs.com/mpp0905/p/9502856.html),   4.[Nginx,Apache,Tomcat区别](https://www.cnblogs.com/suixin84/p/6491579.html),   5.[Apache和Nginx的区别](https://www.cnblogs.com/changning0822/p/7844004.html),   6.[正向代理和反向代理的区别](http://baijiahao.baidu.com/s?id=1600687025749463237&wfr=spider&for=pc),   7.[谈一谈正向代理和反向代理](https://blog.csdn.net/zt15732625878/article/details/78941268)，   8.[正向代理与反向代理【总结】](https://www.cnblogs.com/Anker/p/6056540.html)